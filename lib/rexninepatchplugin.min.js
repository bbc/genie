function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function i(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,i=o(t);if(e){var n=o(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return c(this,r)}}function u(t,e,r){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=o(t)););return t}(t,e);if(i){var n=Object.getOwnPropertyDescriptor(i,e);return n.get?n.get.call(r):n.value}})(t,e,r||t)}var a=function(t){return"[object Array]"===Object.prototype.toString.call(t)},l=function(t,e,r){return void 0===r&&(r="image"),t[e]||(t[e]=t.scene.make[r]({add:!1,origin:{x:0,y:0}}),t.on("destroy",(function(){t[e]&&(t[e].destroy(),t[e]=void 0)}))),t[e]},f=Phaser.Utils.Objects.IsPlainObject,d=Phaser.Utils.Objects.GetValue,m=function(t){return"string"==typeof t&&(t=v[t]),t},v={scale:0,repeat:1},y=function(t,e){return 0===t||t===this.columns.count-1||0===e||e===this.rows.count-1},p={setTexture:function(t,e,r,i){a(e)&&(i=r,r=e,e=void 0),void 0===e&&(e="__BASE"),this.textureKey=t,this.baseFrameName=e,this.columns.data=r,this.columns.count=r?r.length:0,this.columns.stretch=0,this.columns.minWidth=0,this.rows.data=i,this.rows.count=i?i.length:0,this.rows.stretch=0,this.rows.minHeight=0;var n=this.scene.textures.get(t);if(!n)return this.clear(),this;if(!r||!i)return this.clear(),this;for(var o=n.frames[e],s=o.width,c=0,h=0,u=r.length;h<u;h++)void 0===r[h]?c++:"number"==typeof r[h]?s-=r[h]:s-=r[h].width;var l=s/c,f=o.height,d=0;for(h=0,u=i.length;h<u;h++)void 0===i[h]?d++:"number"==typeof i[h]?f-=i[h]:f-=i[h].width;for(var m,v,y,p,g,b=f/d,w=0,O=0,j=0,x=i.length;j<x;j++){void 0===i[j]&&(i[j]=b),"number"==typeof i[j]&&(i[j]={height:i[j],stretch:j%2}),y=(m=i[j]).height,this.rows.stretch+=0|m.stretch,this.rows.minHeight+=m.stretch>0?0:y,w=0;h=0;for(var P=r.length;h<P;h++)void 0===r[h]&&(r[h]=l),"number"==typeof r[h]&&(r[h]={width:r[h],stretch:h%2}),p=(v=r[h]).width,0===j&&(this.columns.stretch+=0|v.stretch,this.columns.minWidth+=v.stretch>0?0:p),p>=1&&y>=1?(g=this.getFrameNameCallback(h,j,e))&&n.add(g,0,w+o.cutX,O+o.cutY,p,y):console.warn("Size of Grid(".concat(h,",").concat(j,") = ").concat(p,"x").concat(y,", which is invalid")),w+=p;O+=y}return this.updateTexture(),this},updateTexture:function(){if(this.clear(),void 0===this.textureKey)return this;var t=this.scene.textures.get(this.textureKey);if(!t)return this;var e,r,i=this.width-this.columns.minWidth;i>=0?(e=this.columns.stretch>0?i/this.columns.stretch:0,r=1):(e=0,r=this.width/this.columns.minWidth);var n,o,s,c,h,u,a,f=this.height-this.rows.minHeight;f>=0?(n=this.rows.stretch>0?f/this.rows.stretch:0,o=1):(n=0,o=this.height/this.rows.minHeight);for(var d,m=0,v=0,y=0,p=this.rows.count;y<p;y++){a=0===(h=this.rows.data[y]).stretch?h.height*o:n*h.stretch,m=0;for(var g=0,b=this.columns.count;g<b;g++)u=0===(c=this.columns.data[g]).stretch?c.width*r:e*c.stretch,(s=this.getFrameNameCallback(g,y,this.baseFrameName))&&u>0&&a>0&&t.has(s)&&(0===(0===h.stretch&&0===c.stretch||0===this.getStretchMode(g,y)?0:1)?(d=l(this,"_image","image")).setTexture(this.textureKey,s).setDisplaySize(u,a):(d=l(this,"_tileSprite","tileSprite")).setTexture(this.textureKey,s).setSize(u,a)),d&&(this.draw(d,m,v),d=void 0),m+=u;v+=a}},setStretchMode:function(t){return f(t)?(this.stretchMode.edge=m(d(t,"edge",0)),this.stretchMode.internal=m(d(t,"internal",0))):(t=m(t),this.stretchMode.edge=t,this.stretchMode.internal=t),this},getStretchMode:function(t,e){return y.call(this,t,e)?this.stretchMode.edge:this.stretchMode.internal}},g=function(t,e,r){return"__BASE"===r?"".concat(t,",").concat(e):"".concat(r,"_").concat(t,",").concat(e)},b=Phaser.GameObjects.RenderTexture,w=Phaser.Utils.Objects.IsPlainObject,O=Phaser.Utils.Objects.GetValue,j=function(t){n(s,b);var r=h(s);function s(t,i,n,o,c,h,u,l,f,d){var m;return e(this,s),w(i)?(i=O(d=i,"x",0),n=O(d,"y",0),o=O(d,"width",1),c=O(d,"height",1),h=O(d,"key",void 0),u=O(d,"baseFrame",void 0),l=O(d,"columns",void 0),f=O(d,"rows",void 0)):w(o)?(o=O(d=o,"width",1),c=O(d,"height",1),h=O(d,"key",void 0),u=O(d,"baseFrame",void 0),l=O(d,"columns",void 0),f=O(d,"rows",void 0)):w(h)?(h=O(d=h,"key",void 0),u=O(d,"baseFrame",void 0),l=O(d,"columns",void 0),f=O(d,"rows",void 0)):w(u)?(u=O(d=u,"baseFrame",void 0),l=O(d,"columns",void 0),f=O(d,"rows",void 0)):a(u)?(d=f,f=l,l=u,u=O(d,"baseFrame",void 0)):w(l)&&(l=O(d=l,"columns",void 0),f=O(d,"rows",void 0)),(m=r.call(this,t,i,n,o,c)).columns={},m.rows={},m.stretchMode={},m._tileSprite=void 0,m._image=void 0,m.setOrigin(.5,.5),m.setGetFrameNameCallback(O(d,"getFrameNameCallback",void 0)),m.setStretchMode(O(d,"stretchMode",0)),m.setTexture(h,u,l,f),m}return i(s,[{key:"setGetFrameNameCallback",value:function(t){return void 0===t&&(t=g),this.getFrameNameCallback=t,this}},{key:"resize",value:function(t,e){return this.width===t&&this.height===e||(u(o(s.prototype),"resize",this).call(this,t,e),this.updateTexture()),this}},{key:"minWidth",get:function(){return this.columns.minWidth}},{key:"minHeight",get:function(){return this.rows.minHeight}}]),s}();function x(t,e,r,i,n,o,s,c,h){var u=new j(this.scene,t,e,r,i,n,o,s,c,h);return this.scene.add.existing(u),u}Object.assign(j.prototype,p);var P=Phaser.GameObjects.BuildGameObject;function S(t,e){void 0===t&&(t={}),void 0!==e&&(t.add=e);var r=new j(this.scene,t);return P(this.scene,r,t),r}var _=function(t){return null==t||""===t||0===t.length},k=function(t){n(o,Phaser.Plugins.BasePlugin);var r=h(o);function o(t){var i;return e(this,o),i=r.call(this,t),t.registerGameObject("rexNinePatch",x,S),i}return i(o,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}}]),o}();!function(e,r,i){if("object"===t(e)){if(_(r)){if(null==i)return;"object"===t(i)&&(e=i)}else{"string"==typeof r&&(r=r.split("."));var n=r.pop();(function(e,r,i){var n=e;if(_(r));else{var o;"string"==typeof r&&(r=r.split("."));for(var s=0,c=r.length;s<c;s++){var h;if(null==n[o=r[s]]||"object"!==t(n[o]))h=s===c-1?void 0===i?{}:i:{},n[o]=h;n=n[o]}}return n}(e,r))[n]=i}}}(window,"RexPlugins.GameObjects.NinePatch",j);export default k;
